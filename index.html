<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>PlayReport ‚Äì Live Scores</title>

<style>
    body {
        margin: 0;
        font-family: Arial, sans-serif;
        background: #0d0d0d;
        color: #fff;
    }
    header {
        text-align: center;
        padding: 18px;
        background: #111;
        border-bottom: 2px solid #d4af37;
        font-size: 22px;
        color: #d4af37;
        font-weight: bold;
    }
    .container {
        max-width: 900px;
        margin: auto;
        padding: 15px;
    }
    textarea {
        width: 100%;
        height: 360px;
        padding: 12px;
        font-size: 16px;
        background: #1a1a1a;
        color: #fff;
        border: 1px solid #333;
        border-radius: 6px;
    }
    .copyBtn {
        width: 100%;
        padding: 15px;
        background: #d4af37;
        color: #111;
        font-size: 18px;
        font-weight: bold;
        border: none;
        border-radius: 6px;
        margin-top: 10px;
    }
</style>
</head>

<body>

<header>PlayReport ‚Äì Facebook Score Formatter</header>

<div class="container">
    <textarea id="fbOutput">Loading...</textarea>

    <button class="copyBtn"
        onclick="navigator.clipboard.writeText(document.getElementById('fbOutput').value); alert('Copied for Facebook!');">
        Copy Facebook Format
    </button>
</div>

<script>
function getFlag(country) {
    if (!country) return "üåç";
    return country.replace(/./g, c =>
        String.fromCodePoint(c.charCodeAt(0) + 127397)
    );
}

function square(type) {
    return type === "red" ? "üü•" : "üü¶";
}

function formatTime24(dateStr) {
    const d = new Date(dateStr);
    const h = d.getHours().toString().padStart(2, "0");
    const m = d.getMinutes().toString().padStart(2, "0");
    return `${h}:${m}`;
}

async function loadScores() {
    const key = "def406a33f7b7b334d338f483f0d2c39"; // <<<<<< REPLACE THIS

    try {
        // ---------------- LIVE MATCHES ----------------
        const liveRes = await fetch("https://v3.football.api-sports.io/fixtures?live=all", {
            headers: { "x-apisports-key": key }
        });
        const liveData = await liveRes.json();
        let live = liveData.response || [];

        // ---------------- LAST FT MATCHES ----------------
        const ftRes = await fetch("https://v3.football.api-sports.io/fixtures?last=100", {
            headers: { "x-apisports-key": key }
        });
        const ftData = await ftRes.json();
        let list = ftData.response || [];

        const now = Date.now();
        const eightHours = 8 * 60 * 60 * 1000;

        let ftLast8 = list.filter(m => {
            if (m.fixture.status.short !== "FT") return false;
            const ts = m.fixture.timestamp * 1000;
            return (now - ts) <= eightHours;
        });

        // ------------------------------------------------------
        // BUILD FACEBOOK OUTPUT
        // ------------------------------------------------------
        let fb = "";

        fb += `‚öΩ LIVE SCORE UPDATES (SA Time)\n\n`;

        // LIVE SECTION
        fb += `üî¥ *LIVE MATCHES*\n`;

        if (live.length === 0) {
            fb += `No live matches right now.\n\n`;
        } else {
            live.forEach(m => {
                const flag = getFlag(m.league.country);
                const league = m.league.name;
                const home = m.teams.home.name;
                const away = m.teams.away.name;
                const hg = m.goals.home;
                const ag = m.goals.away;
                const min = m.fixture.status.elapsed ? `${m.fixture.status.elapsed}'` : "";
                const kick = formatTime24(m.fixture.date);

                fb += `${flag} ${league}\n`;
                fb += `‚è±Ô∏è ${kick} | ${home} ${square("red")} ${hg} ${square("red")} ${ag} ${away} (${min})\n\n`;
            });
        }

        // FT SECTION
        fb += `üü¢ *FULL-TIME RESULTS (Last 8 hrs)*\n`;

        if (ftLast8.length === 0) {
            fb += `No results in last 8 hours.\n`;
        } else {
            ftLast8.forEach(m => {
                const flag = getFlag(m.league.country);
                const league = m.league.name;
                const home = m.teams.home.name;
                const away = m.teams.away.name;
                const hg = m.goals.home;
                const ag = m.goals.away;
                const kick = formatTime24(m.fixture.date);

                fb += `${flag} ${league}\n`;
                fb += `‚è±Ô∏è ${kick} | ${home} ${square("red")} ${hg} ${square("blue")} ${ag} ${away} (FT)\n\n`;
            });
        }

        document.getElementById("fbOutput").value = fb.trim();

    } catch (err) {
        document.getElementById("fbOutput").value = "Error loading data.";
        console.log("ERR:", err);
    }
}

// Load immediately + every 30 seconds
loadScores();
setInterval(loadScores, 30000);
</script>

</body>
</html>
