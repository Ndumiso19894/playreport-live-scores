<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>PlayReport ‚Äì Facebook Score Formatter</title>

<style>
    body {
        margin: 0;
        font-family: Arial, sans-serif;
        background: #0d0d0d;
        color: #fff;
    }
    header {
        text-align: center;
        padding: 18px;
        background: #111;
        border-bottom: 2px solid #d4af37;
        font-size: 22px;
        color: #d4af37;
        font-weight: bold;
    }
    .container {
        max-width: 900px;
        margin: auto;
        padding: 15px;
    }
    textarea {
        width: 100%;
        height: 360px;
        padding: 12px;
        font-size: 16px;
        background: #1a1a1a;
        color: #fff;
        border: 1px solid #333;
        border-radius: 6px;
    }
    .copyBtn {
        width: 100%;
        padding: 15px;
        background: #d4af37;
        color: #111;
        font-size: 18px;
        font-weight: bold;
        border: none;
        border-radius: 6px;
        margin-top: 10px;
    }
</style>
</head>

<body>

<header>PlayReport ‚Äì Facebook Score Formatter</header>

<div class="container">
    <textarea id="fbOutput">Loading...</textarea>

    <button class="copyBtn"
        onclick="navigator.clipboard.writeText(document.getElementById('fbOutput').value); alert('Copied for Facebook!');">
        Copy Facebook Format
    </button>
</div>

<script>
// Convert "ZA" ‚Üí üáøüá¶
function getFlag(code) {
    if (!code) return "üåç";
    return code.replace(/./g, c =>
        String.fromCodePoint(c.charCodeAt(0) + 127397)
    );
}

// Score squares
function red() { return "üü•"; }
function blue() { return "üü¶"; }

// Time in 24h format
function formatTime24(dStr) {
    const d = new Date(dStr);
    return d.getHours().toString().padStart(2,"0") + ":" +
           d.getMinutes().toString().padStart(2,"0");
}

async function loadScores() {
    const key = "def406a33f7b7b334d338f483f0d2c39";  // <<<<<< REPLACE THIS

    try {
        // ---------------- LIVE MATCHES ----------------
        const liveRes = await fetch("https://v3.football.api-sports.io/fixtures?live=all", {
            headers: {
                "x-apisports-key": key,
                "x-rapidapi-host": "v3.football.api-sports.io"
            }
        });
        const liveData = await liveRes.json();
        let live = Array.isArray(liveData.response) ? liveData.response : [];

        // ---------------- FT LAST 8 HOURS ----------------
        const ftRes = await fetch("https://v3.football.api-sports.io/fixtures?last=100", {
            headers: {
                "x-apisports-key": key,
                "x-rapidapi-host": "v3.football.api-sports.io"
            }
        });
        const ftData = await ftRes.json();
        let list = Array.isArray(ftData.response) ? ftData.response : [];

        const now = Date.now();
        const eightHours = 8 * 60 * 60 * 1000;

        let ftLast8 = list.filter(m => {
            if (m.fixture.status.short !== "FT") return false;
            const ts = m.fixture.timestamp * 1000;
            return (now - ts) <= eightHours;
        });

        // Build Facebook output
        let fb = "";
        fb += `‚öΩ LIVE SCORE UPDATES (SA Time)\n\n`;

        // LIVE section
        fb += `üî¥ *LIVE MATCHES*\n`;

        if (live.length === 0) {
            fb += `No live matches right now.\n\n`;
        } else {
            live.forEach(m => {
                const F = getFlag(m.league.country);
                const L = m.league.name;
                const H = m.teams.home.name;
                const A = m.teams.away.name;
                const HG = m.goals.home;
                const AG = m.goals.away;
                const MIN = m.fixture.status.elapsed ? `${m.fixture.status.elapsed}'` : "";
                const KICK = formatTime24(m.fixture.date);

                fb += `${F} ${L}\n`;
                fb += `‚è±Ô∏è ${KICK} | ${H} ${red()} ${HG} ${red()} ${AG} ${A} (${MIN})\n\n`;
            });
        }

        // FT section
        fb += `üü¢ *FULL-TIME RESULTS (Last 8 hrs)*\n`;

        if (ftLast8.length === 0) {
            fb += `No results in last 8 hours.\n`;
        } else {
            ftLast8.forEach(m => {
                const F = getFlag(m.league.country);
                const L = m.league.name;
                const H = m.teams.home.name;
                const A = m.teams.away.name;
                const HG = m.goals.home;
                const AG = m.goals.away;
                const KICK = formatTime24(m.fixture.date);

                fb += `${F} ${L}\n`;
                fb += `‚è±Ô∏è ${KICK} | ${H} ${red()} ${HG} ${blue()} ${AG} ${A} (FT)\n\n`;
            });
        }

        document.getElementById("fbOutput").value = fb.trim();

    } catch (err) {
        document.getElementById("fbOutput").value = "‚ö†Ô∏è Error loading matches.";
        console.log(err);
    }
}

// Load automatically
loadScores();
setInterval(loadScores, 30000);
</script>

</body>
</html>
